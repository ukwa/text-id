// Aa.a: a a a Aa a.N
//N
//////////////////////////////////////////////////////////////////////N
N
#a "a.a"N
#a aN
N
#a a(a:0)N
#a <a0a0.a>N
#a a(a:0)N
N
// #a "a_a.a"N
// #a "a_a.a"N
N
a a_a_a(A a)N
{N
	A _a = a(a);N
	a(  _a					&&N
	  (0==a(_a,".a")	||N
		0==a(_a,".a")	||N
		0==a(_a,".a")	||N
		0==a(_a,".a")	) )N
		*_a = 0;N
}N
N
a a_a_a_a(A a)N
{N
	Aa::Aa& a	= aAa->a_a("a_a_a_a");N
	Aa::AaAa a_	= a.Aa.a();N
	Aa::AaAa a_a_	= a.Aa.a();N
N
	Aa::AaAa a	= a_;N
	Aa::AaAa a_a	= a_a_;N
N
	a(;a!=a_a;++a)N
	{N
		a( a(a, a->a.a_a()) )N
		{N
			a(aAaA<0)N
				a 0;N
			aN
			a(aAaA<0)N
				a 0;N
			aN
				a 0;N
		}N
	}N
N
	a(aAaA<0)N
		a 0;N
	aN
	a(aAaA<0)N
		a 0;N
	aN
		a 0;N
}N
N
a0 a_a_a(a a, a0 a_a, a0 a_a)N
{N
	a(0==a_a)N
		a a_a;N
N
	a _a		= a;N
	a a		= a(a_a);N
N
	a(_a>0){N
		--_a;N
		a		-= a/0.0a;N
	}N
	a aAa	(a);N
}N
N
a a		_A = 0.a;N
//////////////////////////////////////////////////////////////////////N
// Aa aN
//////////////////////////////////////////////////////////////////////N
A a0 AaAaAa0Aa0	(a0 a)N
{N
        a0 a=0;N
        a (a) {a>>=0; a++; };N
        a a;N
}N
A a	Aa				(a& a, a& a, a& a, a& a)N
{N
	a ((a>0) && a)N
	{N
		a /= 0;N
		a /= 0;N
		a -= 0;N
N
		a--;N
	}N
	a (a<0)	a=0;N
	a (a<0)	a=0;N
}N
N
a				A_Aa	(Aa0Aa0* A, A a, A a, A a)N
{N
	a0		a;		a	(a(a),a,a,"_",a,"-",a);N
	a (a a=0; a<a(a_a(a)); a++)	N
		a ('\\'==a[a])	a[a]	= '_';N
	a0		a0;	a	(a(a0),a0,"a\\",a,".a");N
	Aa						("* a a a: ",a0);N
	A_A					(A0AaAaAaAa	(a0,A0A_A,A,0));N
}N
N
Aa0Aa0*	A_AaAaAaAaN
(N
	Aa0Aa0*		a_a,N
	A0A&				a_a_a,N
	a						a_0_a,N
	a0&					a,N
	a0&					aN
)N
{N
	// Aa a & aN
	Aa0Aa0*		a_a			= A;N
	A0A_A			a_a_a0	;N
	A_A					(a_a->AaAaAa	(0,&a_a_a0));N
	a a_a		= a_a->AaAaAa();N
	a a_a			= a_a_a0.Aa;N
	a a_a			= a_a_a0.Aa;N
	Aa					(a_a,a_a,a_a,a_0_a);N
N
	// Aa A-aN
	a (A0A_A==a_a_a)	a_a_a = a_a_a0.Aa;N
	A_A					(A0AaAa(N
		A.aAa,N
		a_a,a_a,N
		a_a,0,a_a_a,N
		A0A_A,&a_aN
		));N
N
	// Aa a & a aN
	Aa0Aa0* A_a= a_a;N
	Aa0Aa0* A_a= a_a;N
N
	a		A_a			= A_a->AaAaAa	()-0;N
	a		A_a			= A_a->AaAaAa	()-0;N
	a (; A_a>=0; A_a--,A_a--)N
	{N
		// Aa aN
		Aa0Aa0		*A_a, *A_a;N
		A_A	(A_a->AaAaAa	(A_a,&A_a));N
		A_A	(A_a->AaAaAa	(A_a,&A_a));N
N
		// AaN
		A_A	(A0AaAaAaAa(A_a,A,A,A_a,A,A,A0A_A_A,0));N
N
		// Aa aN
		_A				(A_a);N
		_A				(A_a);N
	}N
N
	// AN
	a						= a_a;N
	a						= a_a;N
	a					a_a;N
}N
N
a	<a _Aa>N
A	a	A_Aa_0AN
(N
	Aa0Aa0*		a_a,N
	Aa0Aa0*		a_a,N
	a _Aa				aN
)N
{N
	A a							= a_a->AaAaAa();N
	A_A							(a == a_a->AaAaAa());N
	a (A a = 0; a < a; a++)	{N
		A0A_A				Aa,Aa;N
		A0A_A				a,aA;N
N
		a_a->AaAaAa			(a, &a);N
		a_a->AaAaAa			(a, &aA);N
		A						(a.Aa==aA.Aa);N
		A						(a.Aa==A0A_A0A0A0A0);N
		a_a->AaAa				(a,&Aa,0,0);N
		a_a->AaAa				(a,&Aa,0,0);N
		a (a0 a = 0; a < a.Aa; a++)	{N
			a (a0 a = 0; a < a.Aa; a++)	{N
				A&	aAa	= *(((A*)((A*)Aa.aAa + (a * Aa.Aa)))+a);N
				A&	aAa	= *(((A*)((A*)Aa.aAa + (a * Aa.Aa)))+a);N
				aAa			= a(aAa,aAa);N
			}N
		}N
		a_a->AaAa			(a);N
		a_a->AaAa			(a);N
	}N
}N
a	<a _Aa>N
A	a	A_Aa_0AN
(N
	Aa0Aa0*		a_a,N
	Aa0Aa0*		a_a0,N
	Aa0Aa0*		a_a0,N
	a _Aa				aN
 )N
{N
	A a							= a_a->AaAaAa();N
	A_A							(a == a_a0->AaAaAa());N
	A_A							(a == a_a0->AaAaAa());N
	a (A a = 0; a < a; a++)	{N
		A0A_A				Aa0,Aa0,Aa;N
		A0A_A				a,aA0,aA0;N
N
		a_a->AaAaAa			(a, &a);N
		a_a0->AaAaAa		(a, &aA0);N
		a_a0->AaAaAa		(a, &aA0);N
		A						(a.Aa==aA0.Aa);N
		A						(a.Aa==aA0.Aa);N
		A						(a.Aa==A0A_A0A0A0A0);N
		a_a0->AaAa			(a,&Aa0,	0,0);N
		a_a0->AaAa			(a,&Aa0,	0,0);N
		a_a->AaAa				(a,&Aa,	0,0);N
		a (a0 a = 0; a < a.Aa; a++)	{N
			a (a0 a = 0; a < a.Aa; a++)	{N
				A&	aAa0	= *(((A*)((A*)Aa0.aAa + (a * Aa0.Aa)))+a);N
				A&	aAa0	= *(((A*)((A*)Aa0.aAa + (a * Aa0.Aa)))+a);N
				A&	aAa	= *(((A*)((A*)Aa.aAa  + (a * Aa.Aa)))+a);N
				aAa			= a(aAa,aAa0,aAa0);N
			}N
		}N
		a_a->AaAa			(a);N
		a_a0->AaAa			(a);N
		a_a0->AaAa			(a);N
	}N
}N
N
A a0 a_a_a		(a0 a, a0 a)	{	a	a_a	(N
	a_a_A(a),		// aN
	a_a_A(a),N
	a_a_A(a),N
	a_a_A(a)		);N
}N
A a0 a_a_a_a(a0 a, a0 a)	{	N
	a0		a		= a_a_A(a)/0;N
	a0		a		= 0;N
	a0		a	= (a*0+a*0)/0;N
	a	a_a	(N
		a,			// aN
		a_a_A(a),N
		a_a_A(a),N
		a_a_A(a)N
	);N
}N
A a0 a_a	(a0 a, a0 a, a0 a)	{	a	a_a(N
	0+(a(a_a_A(a))-a(a_a_A(a)))*0,		// A-aN
	0+(a(a_a_A(a))-a(a_a_A(a)))*0,		// A-aN
	0+(a(a_a_A(a))-a(a_a_A(a)))*0,		// A-aN
	0+(a(a_a_A(a))-a(a_a_A(a)))*0	);	// A-a	N
}N
A a0 a_a_a	(a0 a, a0 a)	{	a	a_a	(N
	a_a_A(a),					// a aN
	a_a_A(a),					// a aN
	a_a_A(a),					// a aN
	a_a_A(a)	);				// aN
}N
A a0 a_a_a_a(a0 a, a0 a)	{	a	a_a	(N
	a_a_A(a),					// a aN
	a_a_A(a),					// a aN
	a_a_A(a),					// a aN
	(a_a_A(a)+a_a_A(a)+a_a_A(a))/0	);	// aN
}N
N
Aa0AaAa0*	Aa::a_a(A aAa, a0& a_a)N
{N
	Aa0Aa0*		aAa0A		= A;N
	Aa0AaAa0*	aAaA	= A;N
	a_a				a;N
	a0						aAa,aAa;N
	a0						a_a		= 0;N
	a						a_a_a	= 0;N
	A0A				a;N
	a0						a_a=a0(-0);N
	// aN
	A_A				(aAa);N
	A_A				(aAa[0]);N
N
	// a a aN
	a_a				a;N
	a(a,aAa); //. a a (a(a)) *a(a)=0;N
	a_a_a		(a);N
	Aa* A				= A;N
	//a (A.a(a,"$a_a$",a,	".a")	&& a(a,"_a"))	a _A;N
	a (!A.a(a,"$a_a$",	a,	".a")	&& a(a,"_a"))	a _A_a_a;N
	a (A.a(a,"$a$",			a,	".a"))							a _A;N
	a (A.a(a,"$a_a$",		a,	".a"))							a _A;N
	a (A.a(a,"$a_a$",	a,	".a"))							a _A;N
N
	Aa.a(A_A,"Aa'a a a '%a'",a);N
N
	a 0;N
N
_A:N
	{N
		// Aa a a aN
		A0A_A			A;N
		A						= A.a_a	(a);N
#a AN
		Aa						("* Aa: %a[%a]a",a,A->a());N
#a // AN
		a_a				= A->a	();N
		A_A				(A);N
		A_A0					(A0AaAaAaAaAaAaAa	(A->a(),A->a(),&A), a);N
		a (A.AaAa	== A0A_A)			a _A_A;N
		a														a _A_0A;N
N
_A_A:N
		{N
			A_A(A0AaAaAaAaAaAaAaAa(N
				A.aAa,N
				A->a(),A->a(),N
				A0A_A,N
				A.AaAa,0,N
				A.Aa,N
				A0A_A,N
				A0A_A,N
				A0A_A,N
				0,&A,0,N
				&aAaAN
				));N
			A.a_a				(A);N
N
			// AN
			aAa					= A.Aa;N
			aAa				= A.Aa;N
			a						= A.Aa;N
			a_a				= a_a_a(a_a_a, a_a, a_a);N
			a_a					= aAaA->AaAaAa();N
			a					aAaA;N
		}N
_A_0A:N
		{N
			// Aa a A a a a aN
			a					(a);N
N
N
			// Aa   A-A-a, a a a aN
			Aa0Aa0*		A_a;N
			A_A0(A0AaAaAaAaAaAaAaN
					(N
						A.aAa,A->a(),A->a(),N
						A0A_A,A0A_A,N
						A.AaAa,0,N
						A.Aa,N
						A0A_A,N
						A0A_A,N
						A0A_A,N
						0,&A,0,N
						&A_aN
					), a);N
			A.a_a				(A);N
			a_a_a			= a_a_a_a(a);N
			aAa0A				= A_AaAaAaAa(A_a,A.Aa, a_a_a, aAa, aAa);N
			a_a					= aAa0A->AaAaAa();N
			_A				(A_a);N
N
			// AN
			a						= A.Aa;N
			a_a				= a_a_a(a_a_a, a_a, a_a);N
			a					aAa0A;N
		}N
	}N
	/*N
_A:N
	{N
		// Aa   A-A-a, a a a aN
		A0A_A			A;N
		Aa* A				= A.a_a	(a);N
		a					= A->a	();N
		Aa0Aa0*		A_a_a;N
		A_A(A0AaAaAaAaAaAaAa(N
			A.aAa,	A->a(),A->a(),N
			A0A_A,A0A_A,	A0A_A,0,A0A_A0A0A0A0,N
			A0A_A,			A0A_A,A0A_A,N
			0,&A,0,&A_a_a	));N
		A.a_a				(A);N
		//A_Aa						(A_a_a,a,"a-0","a");N
N
		// Aa A-a, a a aN
		Aa0Aa0*	A_a_0	= 0;N
		A_A(A0AaAa		(A.aAa,A.Aa,A.Aa,A0A_A,0,A0A_A0A0A0A0,A0A_A,&A_a_0));N
		A_A(A0AaAaAa	(A_a_0,A_a_a,0,0,A0A_A_A,_A));N
		//A_Aa						(A_a_0,a,"a-0","a");N
N
		// Aa a-aN
		A_Aa_0A				(A_a_0,A_a_a,a_a_a);N
		//A_Aa						(A_a_0,a,"a-0","a-A");N
N
		// AaN
		a								= A0A_A0;N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0,a,aAaA,aAa,aAa);N
		//A_Aa						(A_a_0A,a,"a-0","a-A-A");N
		N
#a A==A_A0N
		// Aa (a)N
		a								= A0A_A0A0A0A0;N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0A,a,0,aAa,aAa);N
		// A_Aa						(A_a_0A,a,"a-0","a-A-A");N
N
		// Aa aN
		Aa0Aa0*	A_a_0A = 0;N
		A_A(A0AaAa(A.aAa,aAa,aAa,A_a_0A->AaAaAa(),0,A0A_A0A0A0A0,A0A_A,&A_a_0A));N
		A_Aa_0A				(A_a_0A,A_a_0,A_a_0A,a_a);N
		// A_Aa						(A_a_0A,a,"a-0","a-A-a");N
N
		// Aa a a + a aN
		A_Aa_0A				(A_a_0A,A_a_a,a_a_a);N
		// A_Aa						(A_a_0A,a,"a-0","a-A-a-A");N
N
		// AaN
		a								= A0A_A0;N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0A,a,0,aAa,aAa);N
		// A_Aa						(A_a_0A,a,"a-0","a-A-a-A-A");N
		_A					(A_a_0A	);N
		_A					(A_a_0A	);N
N
		// N
		a0			aA;N
		a			(aA,"$a$",a,"A");N
		a_a			a_a		= Aa.Aa->_AaAa	(aA);N
		a_a->a_a	(A_a_0A	);N
		_A			(A_a_0A	);	// a a a a a a a aN
#aN
N
		// a a aN
		// A_a_0A	- a.a,		aN
		// A_a_0A	- 0*a.a,	a-aN
		_A			(A_a_a	);N
		_A			(A_a_0		);N
		a				A_a_0A;N
	}N
	*/N
_A_a_a:N
	{N
		Aa			("! a-a a a: %a",a);N
//////////////////N
		a (a(a,"_a#"))			N
		{N
			A_A0	(A.a(a,"$a_a$",	"a\\a_a_a#",	".a"), "a_a_a#");N
			A						= A.a_a	(a);N
			A_A0				(A, a);N
			a_a				= A->a	();N
			a		_A_0A;N
		}N
		a (a(a,"_a"))			N
		{N
			A_A0	(A.a(a,"$a_a$",	"a\\a_a_a",	".a"),"a_a_a");N
			A						= A.a_a	(a);N
N
			A_A0	(A, a);N
N
			a_a				= A->a	();N
			a		_A_0A;N
		}N
//////////////////N
N
		*a		(a,"_a")	= 0;N
		A_A0	(A.a(a,"$a_a$",	a,	".a"),a);N
N
		// Aa   A-A-a, a a a aN
		A0A_A			A;N
		A						= A.a_a	(a);N
		a_a				= A->a	();N
		Aa0Aa0*		A_a;N
		A_A0(A0AaAaAaAaAaAaAa(N
			A.aAa,	A->a(),A->a(),N
			A0A_A,A0A_A,	A0A_A,0,A0A_A0A0A0A0,N
			A0A_A,			A0A_A,A0A_A,N
			0,&A,0,&A_a	), a);N
		A.a_a				(A);N
N
		// Aa A-aN
		Aa0Aa0*	A_a_0	= 0;N
		A_A(A0AaAa		(A.aAa,A.Aa,A.Aa,A0A_A,0,A0A_A0A0A0A0,A0A_A, &A_a_0));N
		A_A(A0AaAaAa	(A_a_0,A_a,0,A0A_A_A_A,A0A_A_A,_A));N
N
		// Aa a-aN
		A_Aa_0A				(A_a_0,A_a,a_a_a_a);N
N
		// AaN
		a								= A0A_A0;N
		a_a_a					= a_a_a_a(a);N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0, a, a_a_a, aAa, aAa);N
		a_a							= A_a_0A->AaAaAa();N
N
#a A==A_A0	N
		// Aa (a)N
		a								= A0A_A0A0A0A0;N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0A,a,0,aAa,aAa);N
N
		// Aa aN
		Aa0Aa0*	A_a_0A = 0;N
		A_A(A0AaAa(A.aAa,aAa,aAa,A_a_0A->AaAaAa(),0,A0A_A0A0A0A0,A0A_A,&A_a_0A));N
		A_Aa_0A		(A_a_0A,A_a_0,A_a_0A,a_a);N
N
		// Aa a a + a aN
		A_Aa_0A		(A_a_0A,A_a,a_a_a_a);N
N
		// AaN
		a								= A0A_A0;N
		Aa0Aa0*	A_a_0A	= A_AaAaAaAa(A_a_0A,a,0,aAa,aAa);N
		_A						(A_a_0A	);N
		_A						(A_a_0A	);N
N
		// N
		a0			aA;N
		a			(a(aA),aA,"$a$",a,"_aA");N
		a_a			a_a			= Aa.Aa->_AaAa	(aA);N
		a_a->a_a	(A_a_0A	);N
		_A			(A_a_0A	);	// a a a a a a a aN
#aN
		// A_a_0A	- a.a,		aN
		// A_a_0A	- 0*a.a,	a-aN
		_A			(A_a);N
		_A			(A_a_0);N
		a_a			= a_a_a(a_a_a, a_a, a_a);N
		a				A_a_0A;N
	}N
}N
