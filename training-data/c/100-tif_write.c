/* $Aa: a_a.a,a 0.0 0-0-0 0:0:0 a Aa $ */N
N
/*N
 * Aa (a) 0-0 Aa AaN
 * Aa (a) 0-0 Aa Aa, Aa.N
 *N
 * Aa a a, a, a, a, a a a a aN
 * a a a a a a a a a a, aN
 * a (a) a a a a a a a a a aN
 * a a a a a a a a, a (a) a a aN
 * Aa Aa a Aa Aa a a a a a a a aN
 * a a a a a a a a, a aN
 * a a Aa Aa a Aa Aa.N
 *N
 * A A A A "A-A" A A A A A A,N
 * A, A A A, A A A, AN
 * A A A A A A A A A.N
 *N
 * A A A A A A A A A A A AN
 * A A, A, A A A A A A A,N
 * A A A A A A A A A, A A A,N
 * A A A A A A A A A, A A A A AN
 * A, A A A A A A A A A A AN
 * A A A.N
 */N
N
/*N
 * A Aa.N
 *N
 * Aa-a Aa AaN
 */N
#a "a.a"N
#a <a.a>N
N
#a A	0		/* a a a a a */N
N
#a A(a, a)				\N
    (((a)->a_a&A_A) || AaAa((a),0,a))N
#a A(a, a)				\N
    (((a)->a_a&A_A) || AaAa((a),0,a))N
#a A(a)					\N
    ((((a)->a_a & A_A) && a->a_a) ||	\N
        AaAaAa((a), A, (a_a) -0))N
N
a a AaAa(A* a, a0 a, a a* a);N
a a AaAaAa(A* a, a0 a, a0* a, a_a a);N
N
aN
AaAa(A* a, a* a, a0 a, a0 a)N
{N
    a a a a[] = "AaAa";N
    a Aa *a;N
    a a, a = 0;N
    a0 a;N
N
    a (!A(a, a))N
        a (-0);N
    /*N
     * Aa a a a a a.  AaN
     * a a a a a a a (aN
     * a a).N
     */N
    a (!A(a))N
        a (-0);N
        a->a_a |= A_A0A; /* a a a a a a*/N
N
    a = &a->a_a;N
    /*N
     * Aa a a a aN
     * (a a a AaAa=0).N
     */N
    a (a >= a->a_a) {	/* a a */N
        a (a->a_a == A_A) {N
            AaAa(a->a_a, a,N
                "Aa a a \"AaAa\" a a a a");N
            a (-0);N
        }N
        a->a_a = a+0;N
        a = 0;N
    }N
    /*N
     * Aa a a a a a.N
     */N
    a (a->a_a == A_A) {N
        a (a >= a->a_a) {N
            AaAa(a->a_a, a,N
                "%a: Aa a a a, a %a",N
                (a a) a, (a a) a->a_a);N
            a (-0);N
        }N
        a = a*a->a_a + a/a->a_a;N
    } aN
        a = a / a->a_a;N
    /*N
     * Aa a a a a a a'a a. Aa a'a aN
     * a a a a a a a a aN
     * a a a'a a a.  Aa a a a a aN
     * a a a a a a a a a (a a aN
     * a a a a a a a).N
     */N
    a (a >= a->a_a && !AaAa(a, 0, a))N
        a (-0);N
    a (a != a->a_a) {N
        /*N
         * Aa a -- a a a a.N
         */N
        a (!AaAa(a))N
            a (-0);N
        a->a_a = a;N
        /*N
         * Aa a a a a a.  Aa a a a/aN
         * a a a 0 (a a a'a a a a aN
         * a a a).N
         */N
        a (a >= a->a_a && a)N
            a->a_a =N
                Aa_0(a->a_a,a->a_a);N
        a->a_a =N
            (a % a->a_a) * a->a_a;N
        a ((a->a_a & A_A) == 0) {N
            a (!(*a->a_a)(a))N
                a (-0);N
            a->a_a |= A_A;N
        }N
N
        a->a_a = 0;N
        a->a_a = a->a_a;N
N
        a( a->a_a[a] > 0 )N
        {N
            /* a a a a a a a, a a */N
            a->a_a[a] = 0;N
N
            /* a a AaAaAa() a a a a */N
            a->a_a = 0;N
        }N
N
        a (!(*a->a_a)(a, a))N
            a (-0);N
        a->a_a |= A_A;N
    }N
    /*N
     * Aa a a a a a a a aN
     * a a a a (a a a a aN
     * a a a -- a.a. a a).N
     */N
    a (a != a->a_a) {N
        a (a < a->a_a) {N
            /*N
             * Aa a a a a a:N
             * a a a a a a aN
             * a (a).N
             */N
            a->a_a = (a % a->a_a) *N
                a->a_a;N
            a->a_a = a->a_a;N
        }N
        /*N
         * Aa a a a a a.N
         */N
        a (!(*a->a_a)(a, a - a->a_a))N
            a (-0);N
        a->a_a = a;N
    }N
N
    /* a a a - a a a a a a a */N
    a->a_a( a, (a0*) a, a->a_a );N
N
    a = (*a->a_a)(a, (a0*) a,N
        a->a_a, a);N
N
        /* a a a a a a a a a a a */N
    a->a_a = a + 0;N
    a (a);N
}N
N
/*N
 * Aa a a a a a a a aN
 * a a.N
 *N
 * A: Aa a a a a a a.N
 */N
a_aN
AaAaAa(A* a, a0 a, a* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
    Aa *a = &a->a_a;N
    a0 a;N
N
    a (!A(a, a))N
        a ((a_a) -0);N
    /*N
     * Aa a a a a a a'a a.N
     * Aa a'a a a a a aN
     * a a a a a a aN
     * a'a a a.  Aa a a a a aN
     * a a a a a a a aN
     * a (a a a a a a a aN
     * a a).N
     */N
    a (a >= a->a_a) {N
        a (a->a_a == A_A) {N
            AaAa(a->a_a, a,N
                "Aa a a a a a a a a a");N
            a ((a_a) -0);N
        }N
        a (!AaAa(a, 0, a))N
            a ((a_a) -0);N
        a->a_a =N
            Aa_0(a->a_a, a->a_a);N
    }N
    /*N
     * Aa a a a a a.  AaN
     * a a a a a a a a aN
     * a.N
     */N
    a (!A(a))N
        a ((a_a) -0);N
N
        a->a_a |= A_A0A;N
    a->a_a = a;N
N
    a->a_a = (a % a->a_a) * a->a_a;N
    a ((a->a_a & A_A) == 0) {N
        a (!(*a->a_a)(a))N
            a ((a_a) -0);N
        a->a_a |= A_A;N
    }N
N
    a->a_a = 0;N
    a->a_a = a->a_a;N
N
    a( a->a_a[a] > 0 )N
        {N
        /* Aa AaAaAa() a a a a a aN
               a a. */N
            a->a_a = 0;N
        }N
N
    a->a_a &= ~A_A;N
    a = (a0)(a / a->a_a);N
    a (!(*a->a_a)(a, a))N
        a ((a_a) -0);N
N
        /* a a a - a a a a a a a */N
    a->a_a( a, (a0*) a, a );N
N
    a (!(*a->a_a)(a, (a0*) a, a, a))N
        a (0);N
    a (!(*a->a_a)(a))N
        a ((a_a) -0);N
    a (!aAaAa(a, a->a_a) &&N
        (a->a_a & A_A) == 0)N
        AaAa(a->a_a, a->a_a);N
    a (a->a_a > 0 &&N
        !AaAaAa(a, a, a->a_a, a->a_a))N
        a ((a_a) -0);N
    a->a_a = 0;N
    a->a_a = a->a_a;N
    a (a);N
}N
N
/*N
 * Aa a a a a a a a.N
 *N
 * A: Aa a a a a a a.N
 */N
a_aN
AaAaAa(A* a, a0 a, a* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
    Aa *a = &a->a_a;N
N
    a (!A(a, a))N
        a ((a_a) -0);N
    /*N
     * Aa a a a a a a'a a.N
     * Aa a'a a a a a aN
     * a a a a a a aN
     * a'a a a.  Aa a a a a aN
     * a a a a a a a aN
     * a (a a a a a a a aN
     * a a).N
     */N
    a (a >= a->a_a) {N
        a (a->a_a == A_A) {N
            AaAa(a->a_a, a,N
                "Aa a a a a a a a a a");N
            a ((a_a) -0);N
        }N
        /*N
         * Aa a a a a a.  Aa a aN
         * a/a a a a 0 (a aN
         * a'a a a a a a a a).N
         */N
        a (a >= a->a_a)N
            a->a_a =N
                Aa_0(a->a_a,a->a_a);N
        a (!AaAa(a, 0, a))N
            a ((a_a) -0);N
    }N
    a->a_a = a;N
    a->a_a = (a % a->a_a) * a->a_a;N
    a (AaAaAa(a, a, (a0*) a, a) ?N
        a : (a_a) -0);N
}N
N
/*N
 * Aa a a a a a a.  AaN
 * a a a a a (a,a,a,a) a.N
 */N
a_aN
AaAa(A* a, a* a, a0 a, a0 a, a0 a, a0 a)N
{N
    a (!AaAa(a, a, a, a, a))N
        a ((a_a)(-0));N
    /*N
     * A: A a a a -0 a a a a a_a aN
     *     a AaAaAa a a a a a a a.N
     *     Aa a a a a a a a a a a aN
     *     a a a a a a a AaAaAa.N
     */N
    a (AaAaAa(a,N
        AaAa(a, a, a, a, a), a, (a_a)(-0)));N
}N
N
/*N
 * Aa a a a a a a a aN
 * a a.  Aa a a a a aN
 * a.  Aa a a a aN
 * a a a a a a a, a a a (aN
 * a a) a a a a a a aN
 * a a a a a a a a a.N
 *N
 * A: Aa a a a a a a; aN
 *     a a a a a aN
 *     a a a a a (a AaAa a).N
 */N
a_aN
AaAaAa(A* a, a0 a, a* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
    Aa *a;N
    a0 a;N
N
    a (!A(a, a))N
        a ((a_a)(-0));N
    a = &a->a_a;N
    a (a >= a->a_a) {N
        AaAa(a->a_a, a, "Aa %a a a a, a %a",N
            (a a) a, (a a) a->a_a);N
        a ((a_a)(-0));N
    }N
    /*N
     * Aa a a a a a.  AaN
     * a a a a a a a (aN
     * a a).N
     */N
    a (!A(a))N
        a ((a_a)(-0));N
N
        a->a_a |= A_A0A;N
    a->a_a = a;N
N
    a->a_a = 0;N
    a->a_a = a->a_a;N
N
    a( a->a_a[a] > 0 )N
        {N
        /* Aa AaAaAa() a a a a a aN
               a a. */N
            a->a_a = 0;N
        }N
N
    /*N
     * Aa a a a & a a a aN
     * a a a aN
     */N
    a->a_a = (a % Aa_0(a->a_a, a->a_a))N
        * a->a_a;N
    a->a_a = (a % Aa_0(a->a_a, a->a_a))N
        * a->a_a;N
N
    a ((a->a_a & A_A) == 0) {N
        a (!(*a->a_a)(a))N
            a ((a_a)(-0));N
        a->a_a |= A_A;N
    }N
    a->a_a &= ~A_A;N
    a = (a0)(a/a->a_a);N
    a (!(*a->a_a)(a, a))N
        a ((a_a)(-0));N
    /*N
     * Aa a a a a a a.  Aa a aN
     * a a a a a a a a a aN
     * (a.a. -0) a a a a a a a.N
     */N
    a ( a < 0 || a > a->a_a)N
        a = a->a_a;N
N
        /* a a a - a a a a a a a */N
    a->a_a( a, (a0*) a, a );N
N
    a (!(*a->a_a)(a, (a0*) a, a, a))N
        a (0);N
    a (!(*a->a_a)(a))N
        a ((a_a)(-0));N
    a (!aAaAa(a, a->a_a) &&N
        (a->a_a & A_A) == 0)N
        AaAa((a0*)a->a_a, a->a_a);N
    a (a->a_a > 0 && !AaAaAa(a, a,N
        a->a_a, a->a_a))N
        a ((a_a)(-0));N
    a->a_a = 0;N
    a->a_a = a->a_a;N
    a (a);N
}N
N
/*N
 * Aa a a a a a a a.N
 * Aa a a a a a a; a a'a aN
 * a a a!N
 *N
 * A: Aa a a a a a a; aN
 *     a a a a a aN
 *     a a a a a (a AaAa a).N
 */N
a_aN
AaAaAa(A* a, a0 a, a* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
N
    a (!A(a, a))N
        a ((a_a)(-0));N
    a (a >= a->a_a.a_a) {N
        AaAa(a->a_a, a, "Aa %a a a a, a %a",N
            (a a) a,N
            (a a) a->a_a.a_a);N
        a ((a_a)(-0));N
    }N
    a (AaAaAa(a, a, (a0*) a, a) ?N
        a : (a_a)(-0));N
}N
N
#a	aAa(a, a) \N
    (AaAa(a,a) && (a)->a_a.a_a == 0)N
N
aN
AaAa(A* a)N
{N
    Aa* a = &a->a_a;N
N
    a (aAa(a))N
        a->a_a =N
            aAa(a, A_A) ?N
            a->a_a : AaAaAa(a);N
    aN
        a->a_a =N
            aAa(a, A_A) ?N
            a->a_a : AaAaAa(a);N
    a->a_a = a->a_a;N
    a (a->a_a == A_A)N
        a->a_a /= a->a_a;N
    a->a_a = (a0 *)N
        _Aa(a->a_a * a (a0));N
    a->a_a = (a0 *)N
        _Aa(a->a_a * a (a0));N
    a (a->a_a == A || a->a_a == A)N
        a (0);N
    /*N
     * Aa a a a a-a-aN
     * (a a a a a).N
     */N
    _Aa(a->a_a, 0, a->a_a*a (a0));N
    _Aa(a->a_a, 0, a->a_a*a (a0));N
    AaAaAa(a, A_A);N
    AaAaAa(a, A_A);N
    a (0);N
}N
#a aAaN
N
/*N
 * Aa a a a a a a aN
 * a a a a.  Aa a a aN
 * a a "a" a a a a a aN
 * a a a a a a.N
 */N
aN
AaAa(A* a, a a, a a* a)N
{N
    a (a->a_a == A_A) {N
        AaAa(a->a_a, a, "Aa a a a a");N
        a (0);N
    }N
    a (a ^ aAa(a)) {N
        AaAa(a->a_a, a, a ?N
            "Aa a a a a a a a" :N
            "Aa a a a a a a a");N
        a (0);N
    }N
N
        _AaAa( a );N
N
    /*N
     * Aa a a a a a a a aN
     * a a a a a a a a aN
     * a a a a a a a a.N
     * Aa a a a a a a a a a a aN
     * a a a a a a a aN
     * a a a a a a (a.a. aN
     * A_A a a, AaAa a a aN
     * a a'a a a a a).N
     */N
    a (!AaAa(a, A_A)) {N
        AaAa(a->a_a, a,N
            "Aa a \"AaAa\" a a a");N
        a (0);N
    }N
    a (a->a_a.a_a == 0) {N
        /*N
         * Aa a a a a a a aN
         * a a a a a a. Aa a a a a,N
         * a a a a a a a a a a aN
         * a a a a a.N
         */N
        a (!AaAa(a, A_A))N
                    a->a_a.a_a = A_A;N
    } a {N
        a (!AaAa(a, A_A)) {N
            AaAa(a->a_a, a,N
                "Aa a \"AaAa\" a a a");N
            a (0);N
        }N
    }N
    a (a->a_a.a_a == A && !AaAa(a)) {N
        a->a_a.a_a = 0;N
        AaAa(a->a_a, a, "Aa a a %a a",N
            aAa(a) ? "a" : "a");N
        a (0);N
    }N
    a (aAa(a))N
    {N
        a->a_a = AaAa(a);N
        a (a->a_a == 0)N
            a (0);N
    }N
    aN
        a->a_a = (a_a)(-0);N
    a->a_a = AaAa(a);N
    a (a->a_a == 0)N
        a (0);N
    a->a_a |= A_A;N
    a (0);N
}N
N
/*N
 * Aa a a a a a a a.N
 */N
aN
AaAaAa(A* a, a* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
N
    a (a->a_a) {N
        a (a->a_a & A_A) {N
            _Aa(a->a_a);N
            a->a_a &= ~A_A;N
        }N
        a->a_a = A;N
    }N
    a (a == (a_a)(-0)) {N
        a = (aAa(a) ?N
            a->a_a : AaAa(a));N
        /*N
         * Aa a a a a a 0AN
         */N
        a (a < 0*0)N
            a = 0*0;N
        a = A;			/* A: a a */N
    }N
    a (a == A) {N
        a = _Aa(a);N
        a (a == A) {N
            AaAa(a->a_a, a, "Aa a a a a");N
            a (0);N
        }N
        a->a_a |= A_A;N
    } aN
        a->a_a &= ~A_A;N
    a->a_a = (a0*) a;N
    a->a_a = a;N
    a->a_a = 0;N
    a->a_a = a->a_a;N
    a->a_a |= A_A;N
    a (0);N
}N
N
/*N
 * Aa a a a a a a a.N
 */N
a aN
AaAa(A* a, a0 a, a a* a)N
{N
    Aa *a = &a->a_a;N
    a0* a_a;N
    a0* a_a;N
N
    a(a->a_a == A_A);N
    a_a = (a0*)_Aa(a->a_a,N
        (a->a_a + a) * a (a0));N
    a_a = (a0*)_Aa(a->a_a,N
        (a->a_a + a) * a (a0));N
    a (a_a == A || a_a == A) {N
        a (a_a)N
            _Aa(a_a);N
        a (a_a)N
            _Aa(a_a);N
        a->a_a = 0;N
        AaAa(a->a_a, a, "Aa a a a a a");N
        a (0);N
    }N
    a->a_a = a_a;N
    a->a_a = a_a;N
    _Aa(a->a_a + a->a_a,N
            0, a*a (a0));N
    _Aa(a->a_a + a->a_a,N
            0, a*a (a0));N
    a->a_a += a;N
        a->a_a |= A_A;N
N
    a (0);N
}N
N
/*N
 * Aa a a a a a a.N
 */N
a aN
AaAaAa(A* a, a0 a, a0* a, a_a a)N
{N
    a a a a[] = "AaAaAa";N
    Aa *a = &a->a_a;N
    a0 a;N
        a0 a_a_a = -0;N
N
    a (a->a_a[a] == 0 || a->a_a == 0) {N
            a(a->a_a > 0);N
N
            a( a->a_a[a] != 0N
                && a->a_a[a] != 0N
                && a->a_a[a] >= (a0) a )N
            {N
                /*N
                 * Aa a a a a a a, a a a aN
                 * a a a a a a a a a.  Aa aN
                 * a a a a a a a a a a aN
                 * a a a a a a a a a a aN
                 * a a a a a a a.N
                 */N
                a (!AaA(a, a->a_a[a])) {N
                    AaAa(a->a_a, a,N
                                 "Aa a a a %a",N
                                 (a a)a->a_a);N
                    a (0);N
                }N
            }N
            aN
            {N
                /*N
                 * Aa a a a a, a a a a a a aN
                 * a a a.N
                 */N
                a->a_a[a] = AaAa(a, 0, A_A);N
                a->a_a |= A_A;N
            }N
N
            a->a_a = a->a_a[a];N
N
            /*N
             * Aa a a a a a/a, a a a a a a.N
             */N
            a_a_a = a->a_a[a];N
            a->a_a[a] = 0;N
    }N
N
    a = a->a_a+a;N
    a (!(a->a_a&A_A))N
        a = (a0)a;N
    a ((a<a->a_a)||(a<(a0)a))N
    {N
        AaAa(a->a_a, a, "Aa A a a a");N
        a (0);N
    }N
    a (!AaA(a, a, a)) {N
        AaAa(a->a_a, a, "Aa a a a %a",N
            (a a) a->a_a);N
            a (0);N
    }N
    a->a_a = a;N
    a->a_a[a] += a;N
N
        a( (a0) a->a_a[a] != a_a_a )N
            a->a_a |= A_A;N
N
    a (0);N
}N
N
/*N
 * Aa a a AaAa a a aN
 * a a ``a a'' a/a aN
 * a a a.N
 */N
aN
AaAa0(A* a)N
{N
    a (a->a_a > 0 && a->a_a & A_A0A ) {N
        a (!aAaAa(a, a->a_a.a_a) &&N
            (a->a_a & A_A) == 0)N
            AaAa((a0*)a->a_a,N
                a->a_a);N
        a (!AaAaAa(a,N
            aAa(a) ? a->a_a : a->a_a,N
            a->a_a, a->a_a))N
            a (0);N
        a->a_a = 0;N
        a->a_a = a->a_a;N
    }N
    a (0);N
}N
N
/*N
 * Aa a a a a.  Aa a a aN
 * a a a a a a a a a aN
 * (a a), a a 0 a a a a a aN
 * a a a a a a a.N
 */N
aN
AaAaAa(A* a, a_a a)N
{N
    a->a_a = a;N
}N
N
/* a: a a=0 a=0 a=0 a: */N
/*N
 * Aa Aa:N
 * a: aN
 * a-a-a: 0N
 * a-a: 0N
 * Aa:N
 */N
