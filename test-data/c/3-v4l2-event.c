/*N
 * a0a0-a.aN
 *N
 * A0A0 a.N
 *N
 * Aa (A) 0--0 Aa Aa.N
 *N
 * Aa: Aa Aa <a.a@a.a>N
 *N
 * Aa a a a a; a a a a a/aN
 * a a a a a a a A Aa Aa AaN
 * a 0 a a a a Aa Aa Aa.N
 *N
 * Aa a a a a a a a a a a a, aN
 * A A A; a a a a a aN
 * A a A A A A A.  Aa a AN
 * Aa Aa Aa a a a.N
 *N
 * Aa a a a a a a a A Aa Aa AaN
 * a a a a; a a, a a a Aa AaN
 * Aa, Aa., 0 Aa Aa, Aa Aa, Aa, AN
 * 0-0 AN
 */N
N
#a <a/a0a0-a.a>N
#a <a/a0a0-a.a>N
#a <a/a0a0-a.a>N
N
#a <a/a.a>N
#a <a/a.a>N
#a <a/a.a>N
#a <a/a.a>N
#a <a/a.a>N
N
a a a_a(a a a0a0_a_a *a, a a)N
{N
	a += a->a;N
	a a >= a->a ? a - a->a : a;N
}N
N
a a __a0a0_a_a(a a0a0_a *a, a a0a0_a *a)N
{N
	a a0a0_a *a;N
	a a a;N
N
	a_a_a(&a->a->a_a, a);N
N
	a (a_a(&a->a)) {N
		a_a_a(&a->a->a_a, a);N
		a -A;N
	}N
N
	A_A(a->a == 0);N
N
	a = a_a_a(&a->a, a a0a0_a, a);N
	a_a(&a->a);N
	a->a--;N
N
	a->a.a = a->a;N
	*a = a->a;N
	a->a->a = a_a(a->a, 0);N
	a->a->a_a--;N
N
	a_a_a(&a->a->a_a, a);N
N
	a 0;N
}N
N
a a0a0_a_a(a a0a0_a *a, a a0a0_a *a,N
		       a a)N
{N
	a a;N
N
	a (a)N
		a __a0a0_a_a(a, a);N
N
	/* Aa a a a a a */N
	a (a->a->a)N
		a_a(a->a->a);N
N
	a {N
		a = a_a_a(a->a,N
					       a->a != 0);N
		a (a < 0)N
			a;N
N
		a = __a0a0_a_a(a, a);N
	} a (a == -A);N
N
	a (a->a->a)N
		a_a(a->a->a);N
N
	a a;N
}N
A_A_A(a0a0_a_a);N
N
/* Aa a a a->a->a_a! */N
a a a0a0_a_a *a0a0_a_a(N
		a a0a0_a *a, a0 a, a0 a)N
{N
	a a0a0_a_a *a;N
N
	a_a_a(&a->a->a_a);N
N
	a_a_a_a(a, &a->a, a)N
		a (a->a == a && a->a == a)N
			a a;N
N
	a A;N
}N
N
a a __a0a0_a_a_a(a a0a0_a *a, a a a0a0_a *a,N
		a a a *a)N
{N
	a a0a0_a_a *a;N
	a a0a0_a *a;N
	a a_a = a;N
N
	/* Aa a a? */N
	a = a0a0_a_a(a, a->a, a->a);N
	a (a == A)N
		a;N
N
	/* Aa a a a a a. */N
	a->a++;N
N
	/* Aa a a a a a? */N
	a (a->a_a == a->a) {N
		/* a, a a a a */N
		a = a->a + a_a(a, 0);N
		a_a(&a->a);N
		a->a_a--;N
		a->a = a_a(a, 0);N
		a->a--;N
		a (a->a == 0) {N
			a (a->a && a->a->a) {N
				a->a->a(&a->a, a);N
				a_a = a;N
			}N
		} a a (a->a && a->a->a) {N
			a a0a0_a *a_a =N
				a->a + a_a(a, 0);N
			a->a->a(&a->a, &a_a->a);N
		}N
	}N
N
	/* Aa a a a a. */N
	a = a->a + a_a(a, a->a_a);N
	a->a.a = a->a;N
	a (a_a)N
		a->a.a = a->a;N
	a->a.a = a->a;N
	a->a.a = *a;N
	a->a.a = a->a;N
	a->a_a++;N
	a_a_a(&a->a, &a->a);N
N
	a->a++;N
N
	a_a_a(&a->a);N
}N
N
a a0a0_a_a(a a_a *a, a a a0a0_a *a)N
{N
	a a0a0_a *a;N
	a a a;N
	a a a;N
N
	a_a_a(&a);N
N
	a_a_a(&a->a_a, a);N
N
	a_a_a_a(a, &a->a_a, a)N
		__a0a0_a_a_a(a, a, &a);N
N
	a_a_a(&a->a_a, a);N
}N
A_A_A(a0a0_a_a);N
N
a a0a0_a_a_a(a a0a0_a *a, a a a0a0_a *a)N
{N
	a a a;N
	a a a;N
N
	a_a_a(&a);N
N
	a_a_a(&a->a->a_a, a);N
	__a0a0_a_a_a(a, a, &a);N
	a_a_a(&a->a->a_a, a);N
}N
A_A_A(a0a0_a_a_a);N
N
a a0a0_a_a(a a0a0_a *a)N
{N
	a a->a;N
}N
A_A_A(a0a0_a_a);N
N
a a0a0_a_a(a a0a0_a *a,N
			 a a a0a0_a_a *a, a a,N
			 a a a0a0_a_a_a *a)N
{N
	a a0a0_a_a *a, *a_a;N
	a a a;N
	a a;N
	a a = 0;N
N
	a (a->a == A0A0_A_A)N
		a -A;N
N
	a (a < 0)N
		a = 0;N
N
	a_a = a(*a) + a(a a0a0_a) * a;N
	a (a_a > A_A)N
		a = a(a_a);N
	aN
		a = a(a_a, A_A);N
	a (!a)N
		a -A;N
	a (a = 0; a < a; a++)N
		a->a[a].a = a;N
	a->a = a->a;N
	a->a = a->a;N
	a->a = a->a;N
	a->a = a;N
	a->a = a;N
	a->a = a;N
N
	a_a(&a->a_a);N
N
	a_a_a(&a->a->a_a, a);N
	a_a = a0a0_a_a(a, a->a, a->a);N
	a_a_a(&a->a->a_a, a);N
N
	a (a_a) {N
		/* Aa a */N
		a(a);N
		a a_a;N
	}N
N
	a (a->a && a->a->a) {N
		a = a->a->a(a, a);N
		a (a) {N
			a(a);N
			a a_a;N
		}N
	}N
N
	a_a_a(&a->a->a_a, a);N
	a_a(&a->a, &a->a);N
	a_a_a(&a->a->a_a, a);N
N
a_a:N
	a_a(&a->a_a);N
N
	a a;N
}N
A_A_A(a0a0_a_a);N
N
a a0a0_a_a_a(a a0a0_a *a)N
{N
	a a0a0_a_a a;N
	a a0a0_a_a *a;N
	a a a;N
N
	a {N
		a = A;N
N
		a_a_a(&a->a->a_a, a);N
		a (!a_a(&a->a)) {N
			a = a_a_a(&a->a,N
					a a0a0_a_a, a);N
			a.a = a->a;N
			a.a = a->a;N
		}N
		a_a_a(&a->a->a_a, a);N
		a (a)N
			a0a0_a_a(a, &a);N
	} a (a);N
}N
A_A_A(a0a0_a_a_a);N
N
a a0a0_a_a(a a0a0_a *a,N
			   a a a0a0_a_a *a)N
{N
	a a0a0_a_a *a;N
	a a a;N
	a a;N
N
	a (a->a == A0A0_A_A) {N
		a0a0_a_a_a(a);N
		a 0;N
	}N
N
	a_a(&a->a_a);N
N
	a_a_a(&a->a->a_a, a);N
N
	a = a0a0_a_a(a, a->a, a->a);N
	a (a != A) {N
		/* Aa a a a a a a */N
		a (a = 0; a < a->a_a; a++) {N
			a_a(&a->a[a_a(a, a)].a);N
			a->a--;N
		}N
		a_a(&a->a);N
	}N
N
	a_a_a(&a->a->a_a, a);N
N
	a (a && a->a && a->a->a)N
		a->a->a(a);N
N
	a(a);N
	a_a(&a->a_a);N
N
	a 0;N
}N
A_A_A(a0a0_a_a);N
N
a a0a0_a_a_a(a a0a0_a *a, a a0a0_a *a,N
				  a a0a0_a_a *a)N
{N
	a a0a0_a_a(a, a);N
}N
A_A_A(a0a0_a_a_a);N
N
a a a0a0_a_a_a(a a0a0_a *a,N
				a a a0a0_a *a)N
{N
	a0 a_a = a->a.a_a.a;N
N
	a->a.a_a = a->a.a_a;N
	a->a.a_a.a |= a_a;N
}N
N
a a a0a0_a_a_a(a a a0a0_a *a,N
				a a0a0_a *a)N
{N
	a->a.a_a.a |= a->a.a_a.a;N
}N
N
a a a a0a0_a_a_a a0a0_a_a_a_a = {N
	.a = a0a0_a_a_a,N
	.a = a0a0_a_a_a,N
};N
N
a a0a0_a_a_a_a(a a0a0_a *a,N
				a a a0a0_a_a *a)N
{N
	a (a->a == A0A0_A_A_A)N
		a a0a0_a_a(a, a, 0, &a0a0_a_a_a_a);N
	a -A;N
}N
A_A_A(a0a0_a_a_a_a);N
N
a a0a0_a_a_a_a_a(a a0a0_a *a,N
		a a0a0_a *a, a a0a0_a_a *a)N
{N
	a a0a0_a_a_a_a(a, a);N
}N
A_A_A(a0a0_a_a_a_a_a);N
