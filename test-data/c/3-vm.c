#a "a.a"N
#a "a.a"N
#a "a.a"N
#a "a.a"N
#a "a.a"N
#a "a.a"N
#a "a.a"N
N
/*N
 * a a'a a a.N
 */N
a_a a_a;N
N
a a a[];  // a.a a a a a a a a.N
N
a a a[]; // a.AN
N
a a(a_a);N
N
/*N
 * a a a-a a a a a a aN
 * a a a. a a, a a a.N
 * a a a a a a.N
 */N
aN
a()N
{N
  a_a = (a_a) a();N
  a(a_a, 0, A);N
N
  // a aN
  a(A0, A0, A, A_A | A_A);N
N
  // a a a a 0N
  a(A(0), A(0), A, A_A | A_A);N
N
  // a a a a 0N
  a(A(0), A(0), A, A_A | A_A);N
N
  // AN
  a(A, A, 0a0, A_A | A_A);N
N
  // AN
  a(A, A, 0a0, A_A | A_A);N
N
  // a a a a a a-a.N
  a(A, A, (a0)a-A, A_A | A_A);N
N
  // a a a a a a A a'a a a a.N
  a((a0)a, (a0)a, A-(a0)a, A_A | A_A);N
N
  // a a a a a a/a aN
  // a a a a a a a.N
  a(A, (a0)a, A, A_A | A_A);N
}N
N
// Aa a/a a a a a a a'a a a,N
// a a a.N
aN
a()N
{N
  a_a(A_A(a_a));N
  a_a();N
}N
N
// Aa a a a a A a a a aN
// a a a a a a.  Aa a!=0,N
// a a a a-a a.N
//N
// Aa a-a Aa0 a a a a a a-aN
// a. A a-a a a 0 0-a Aa.N
// A 0-a a a a a a a a:N
//   0..0 -- a a a.N
//   0..0 -- 0 a a a-0 a.N
//   0..0 -- 0 a a a-0 a.N
//   0..0 -- 0 a a a-0 a.N
//    0..0 -- 0 a a a a a a a.N
a a_a *N
a(a_a a, a0 a, a a)N
{N
  a(a >= A)N
    a("a");N
N
  a(a a = 0; a > 0; a--) {N
    a_a *a = &a[A(a, a)];N
    a(*a & A_A) {N
      a = (a_a)A0A(*a);N
    } a {N
      a(!a || (a = (a_a*)a()) == 0)N
        a 0;N
      a(a, 0, A);N
      *a = A0A(a) | A_A;N
    }N
  }N
  a &a[A(0, a)];N
}N
N
// Aa a a a a, a a a a,N
// a 0 a a a.N
// Aa a a a a a a a a.N
a0N
a(a_a a, a0 a)N
{N
  a_a *a;N
  a0 a;N
N
  a(a >= A)N
    a 0;N
N
  a = a(a, a, 0);N
  a(a == 0)N
    a 0;N
  a((*a & A_A) == 0)N
    a 0;N
  a((*a & A_A) == 0)N
    a 0;N
  a = A0A(*a);N
  a a;N
}N
N
// a a a a a a a a.N
// a a a a.N
// a a a A a a a.N
aN
a(a0 a, a0 a, a0 a, a a)N
{N
  a(a(a_a, a, a, a, a) != 0)N
    a("a");N
}N
N
// a a a a a aN
// a a a. a a aN
// a a a a.N
// a a a a a.N
a0N
a(a0 a)N
{N
  a0 a = a % A;N
  a_a *a;N
  a0 a;N
  N
  a = a(a_a, a, 0);N
  a(a == 0)N
    a("a");N
  a((*a & A_A) == 0)N
    a("a");N
  a = A0A(*a);N
  a a+a;N
}N
N
// Aa Aa a a a a a a a a aN
// a a a a a. a a a a aN
// a a-a. Aa 0 a a, -0 a a() a'aN
// a a a a-a a.N
aN
a(a_a a, a0 a, a0 a, a0 a, a a)N
{N
  a0 a, a;N
  a_a *a;N
N
  a = A(a);N
  a = A(a + a - 0);N
  a(;;){N
    a((a = a(a, a, 0)) == 0)N
      a -0;N
    a(*a & A_A)N
      a("a");N
    *a = A0A(a) | a | A_A;N
    a(a == a)N
      a;N
    a += A;N
    a += A;N
  }N
  a 0;N
}N
N
// Aa a a a a a. Aa a aN
// a a a a a. Aa a aN
// a a.N
aN
a(a_a a, a0 a, a0 a, a a_a)N
{N
  a0 a, a;N
  a_a *a;N
  a0 a;N
N
  a = A(a);N
  a = A(a + a - 0);N
  a(;;){N
    a((a = a(a, a, 0)) == 0)N
      a("a: a");N
    a((*a & A_A) == 0){N
      a("a=%a a=%a\a", a, *a);N
      a("a: a a");N
    }N
    a(A_A(*a) == A_A)N
      a("a: a a a");N
    a(a_a){N
      a = A0A(*a);N
      a((a*)a);N
    }N
    *a = 0;N
    a(a == a)N
      a;N
    a += A;N
    a += A;N
  }N
}N
N
// a a a a a a.N
a_aN
a()N
{N
  a_a a;N
  a = (a_a) a();N
  a(a == 0)N
    a("a: a a a");N
  a(a, 0, A);N
  a a;N
}N
N
// Aa a a a a a 0 a a,N
// a a a a a.N
// a a a a a a a.N
aN
a(a_a a, a *a, a a)N
{N
  a *a;N
N
  a(a >= A)N
    a("a: a a a a");N
  a = a();N
  a(a, 0, A);N
  a(a, 0, A, (a0)a, A_A|A_A|A_A|A_A);N
  a(a, a, a);N
}N
N
// Aa Aa a a a a a a a a aN
// a, a a a a a a.  Aa a a a 0 a a.N
a0N
a(a_a a, a0 a, a0 a)N
{N
  a *a;N
  a0 a;N
N
  a(a < a)N
    a a;N
N
  a = A(a);N
  a = a;N
  a(; a < a; a += A){N
    a = a();N
    a(a == 0){N
      a(a, a, a);N
      a 0;N
    }N
    a(a, 0, A);N
    a(a(a, a, A, (a0)a, A_A|A_A|A_A|A_A) != 0){N
      a(a);N
      a(a, a, a);N
      a 0;N
    }N
  }N
  a a;N
}N
N
// Aa a a a a a a a a a aN
// a.  a a a a a a a-a, a a aN
// a a a a a a.  a a a a a a aN
// a a.  Aa a a a a.N
a0N
a(a_a a, a0 a, a0 a)N
{N
  a(a >= a)N
    a a;N
N
  a0 a = A(a);N
  a(a < A(a))N
    a(a, a, a - a, 0);N
N
  a a;N
}N
N
// Aa a a-a a.N
// Aa a a a a a a a.N
a aN
a(a_a a)N
{N
  // a a 0^0 = 0 Aa a a a a.N
  a(a a = 0; a < 0; a++){N
    a_a a = a[a];N
    a((a & A_A) && (a & (A_A|A_A|A_A)) == 0){N
      // a A a a a a-a a a.N
      a0 a = A0A(a);N
      a((a_a)a);N
      a[a] = 0;N
    } a a(a & A_A){N
      a("a: a");N
    }N
  }N
  a((a*)a);N
}N
N
// Aa a a a,N
// a a a-a a.N
aN
a(a_a a, a0 a)N
{N
  a(a, 0, a, 0);N
  a(a);N
}N
N
// Aa a a a'a a a, aN
// a a a a a'a a a.N
// Aa a a a a a aN
// a a.N
// a 0 a a, -0 a a.N
// a a a a a a.N
aN
a(a_a a, a_a a, a0 a)N
{N
  a_a *a;N
  a0 a, a;N
  a a;N
  //a *a;N
N
  a(a = 0; a < a; a += A){N
    a((a = a(a, a, 0)) == 0)N
      a("a: a a a");N
    a((*a & A_A) == 0)N
      a("a: a a a");N
    // Aa a a a, a a a a a A a AN
    a(*a & A_A) {N
        *a ^= A_A;N
        *a |= A_A;N
    }N
    a = A0A(*a);N
    a = A_A(*a);N
    /*N
    a((a = a()) == 0)N
      a a;N
    a(a, (a*)a, A);N
    a(a(a, a, A, (a0)a, a) != 0){N
      a(a);N
      a a;N
    }*/N
    a(a(a, a, A, a, a) != 0) {N
        a a;N
    }N
    // a a a, a a a a a AN
    a_a((a*)a);N
  }N
  a 0;N
N
 a:N
  a(a, 0, a, 0);N
  a -0;N
}N
N
a a(a_a a, a0 a)N
{N
    a_a *a;N
    a0 a;N
    a a;N
    a * a;N
N
    a = a(a, a, 0);N
    // a A aN
    a (a == 0)N
        a("a: a a a");N
    // a A a a a aN
    a((*a && A_A) == 0)N
        a("a: a a a");N
    // Aa A_A a a aN
    a(!(*a & A_A)) {N
        a("a: A_A a a a 0a%a\a", a);N
        a -0;N
    }N
N
    // Aa a a a a, a a a A_A a 0 a A_A 0N
    // Aa a a a a AN
    a = A0A(*a);N
    a = A_A(*a);N
    a ^= A_A;N
    a |= A_A;N
N
    // Aa a aN
    a ((a = a()) == 0)N
    {N
        a("a: a a");N
        a -0;N
    }N
    a(a, (a*)a, A);N
    a(a, A(a), A, 0);N
    a (a(a, A(a), A, (a0)a, a) != 0)N
    {N
        a("a: a\a");N
        a(a);N
        a -0;N
    }N
    a 0;N
}N
N
// a a A a a a a.N
// a a a a a a a a a.N
aN
a(a_a a, a0 a)N
{N
  a_a *a;N
  N
  a = a(a, a, 0);N
  a(a == 0)N
    a("a");N
  *a &= ~A_A;N
}N
N
// Aa a a a a.N
// Aa a a a a a a a a a a a a a.N
// Aa 0 a a, -0 a a.N
aN
a(a_a a, a0 a, a *a, a0 a)N
{N
     a0 a, a0, a0;N
N
     //A: A A A A AN
     a_a a = A0A(a);N
N
      a (a == 0)N
          a -0;N
      a (a & A_A)N
      {N
          a(a(a, a) < 0)N
              a("a: a a\a");N
      }N
N
  a(a > 0){N
      a0 = A(a);N
N
      a0 = a(a, a0);N
      a(a0 == 0)N
          a -0;N
      a = A - (a - a0);N
      a(a > a)N
          a = a;N
      a((a *)(a0 + (a - a0)), a, a);N
N
      a -= a;N
      a += a;N
      a = a0 + A;N
  }N
  a 0;N
}N
N
// Aa a a a a.N
// Aa a a a a a a a a a a a a a.N
// Aa 0 a a, -0 a a.N
aN
a(a_a a, a *a, a0 a, a0 a)N
{N
  a0 a, a0, a0;N
N
  a(a > 0){N
    a0 = A(a);N
    a0 = a(a, a0);N
    a(a0 == 0)N
      a -0;N
    a = A - (a - a0);N
    a(a > a)N
      a = a;N
    a(a, (a *)(a0 + (a - a0)), a);N
N
    a -= a;N
    a += a;N
    a = a0 + A;N
  }N
  a 0;N
}N
N
// Aa a a-a a a a a a.N
// Aa a a a a a a a a a a a a,N
// a a '\0', a a.N
// Aa 0 a a, -0 a a.N
aN
a(a_a a, a *a, a0 a, a0 a)N
{N
  a0 a, a0, a0;N
  a a_a = 0;N
N
  a(a_a == 0 && a > 0){N
    a0 = A(a);N
    a0 = a(a, a0);N
    a(a0 == 0)N
      a -0;N
    a = A - (a - a0);N
    a(a > a)N
      a = a;N
N
    a *a = (a *) (a0 + (a - a0));N
    a(a > 0){N
      a(*a == '\0'){N
        *a = '\0';N
        a_a = 0;N
        a;N
      } a {N
        *a = *a;N
      }N
      --a;N
      --a;N
      a++;N
      a++;N
    }N
N
    a = a0 + A;N
  }N
  a(a_a){N
    a 0;N
  } a {N
    a -0;N
  }N
}N
